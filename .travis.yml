language: java
jdk: oraclejdk8
services:
  - postgresql
addons:
  postgresql: '9.6'
script:
  - "./gradlew check"
after_success:
  - bash <(curl -s https://codecov.io/bash)
env:
  global:
    - secure: Nq9tI0s4JpHZakclIpeebndC31CUahC6jwLKMFWuKIYRiBEhPbFva8ZKK0yzyyRZvYg0Xuevv+VEdqItoeYDnCKJaTJ4Fpipar7y9IKhIpSf02JmRNqKGOPq9q8UptW9igzpR6MNWs+5mBbQsOJOKNtAQhq+CJMiGmlnBXfbDuUPdgkpxbrgxW+SrcxBRTe5B7vYmQjbGGIyoEn9N0PFYIVy+yTTaVqWQDCc2AzG/pODGKlni8CCbUHVuLRJVVtgGy7CL1GcBUJQWDcsEJxOsJRpWDZlShkCLaWMNxMxnq0GyfIlp7KS5sUGNrOp9OeRGUHO1nca3sDIW/fSJJlk48NKc/298Df/ZQX3bYkU0DTayRCpj7nZ/GH6trCDlUm7tpdphQd0++vn271sCcRp5aCmIPS8opSwZ9W1B1KuBrgGhxbpckCCboNoLbxYcVMISNDMxnypBKgE4pR+p8Abjt256+ZGm2mlDy4cADPUbKi3gxSFc7IljK5zkNfzBkODAeqYBfVCGelOm2GOp7tgFHJZb+Xus1FgkzcSqZ6qqq3T8eA0/z+5Ha+gPOy5p+bAsyfO7UnO15MGpZ0uAbmTeaTXxiyNL2BxRnRQNlqlTKGJ5aYPUu1gc8G3hlPfgYX3srAZBCgAeQVjA+ljuoPlclfSHjZmSuunpfhAsmssHtI=
    - secure: Lr/wWhxcLdCLijxll0ztfZY66BDaD0S6BG5qx7DHLCCh2CRxVarQB/5TBiRYbSqOOkOYLSTGtNUP+izyKXJcdq9ywBO9QdGFRVAYqwNBh9mJgz3C0aKWhpebD59gaCWLo6976zXAuAOuhpt6HKIRxObI+eMMNQ4Vq67fuzlSHgFYmGr53excN5x9WmK8f3OEemo3pDh9ctnVqfRrEpNutZzL0UU3OPk4yhw681p7cP4dF5uzthNr9pPzqr92yu7/OjA8MZgngv5c8avPU9Z0Y9heOkPtVt/q4WIpLiH7S/4iJQ+jQArGre/e/J7nhf7UBkKXzkNotTg/O7vGPWVScrsi/2B68FJDC7Mt8kvgRq4MEG9pjSoA6lxXsxUllie5JfwMk3Gy6cBlcMODd+jQIQixK4zfjX7c20kaX8cS0TInnSIwumrEoGdhFwpQs90Kr0XGp+0FWPD7njA96HjD56qEFIpDxj6l32TncMqYKs9poexeS4rlt+3N3zxwutQ4vMbgDFIEQZ88Vhft29UZHmyRwOWN134Y01i52yg1y2QfQQaivsXJ+Bh9pue3AHsRHId87YBVw4m0YhU0LDyzg1XuiK8HnMgMmJepAFhk+JhrodDWbKwoQjTcqljnm+BbPr2w57pr4eUon7wG9MHNL+3Uz/1uoyLYZmNeWTb1oJU=
branches:
  only:
    - master
notifications:
  slack:
    secure: R8Sknu2eKb2rt99R0G/APkV3OpB3AbhjY8r+uHT1bWX80/khTtFWyhXTQ1s+HWExOA7G6nWCH3cBef3HHC4fVWdYWs7nvT2JbH6moxdMwAZN0YsvK/0mlEfUf1MjswImaBsuFxu+Z6ZAP7/0rhRO19f4OTxvHoB+wQ5HsoqeNAHOUO/DhbcBzI6v6ZSDswIu3o5dGCBR23comXwXGrC76ZAA6liL3ZyYv9pbQNkD+UkP1JAVaJ4aUxQqHcf3KheR4hqAXBIcbb/0v3M6SkSlHV8NskasBN1rJ1EEB9dIFkp0JCay2gtOwpiwxPndLVApWAr2X6CMHAdSYkg2ze7ccwO5je0/2PotQoEPvbpgPcI0eQDNo9E8hogGnxNM4yZa//ZFI8SNvMwoOKkwjQ63SjlB971mNLVosELPEv+Dft9USx9x6U0/d+YQfE9Mh9hPh+YNz7TXQjxaUiG6Q8sHn2s0pXFtHzd/OtHwDkrcEEcXFaFyLfvlTWlr8NLe7b0RNy1LNlToTHa4pw7QP01J45l9cPsP952eTcTmDYEBAIAniC1OTKtu1ROQOXr6Q8M5LNSKYeFbapL/DWWOor1C+XmdLH/yl+vzJIDH3BFaUxFmB3k4mSbtP2VREETxidmYj3nATWv00JWTDNEfNoCl4dMvEV1CMdTkj8lETcHAKI0=
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - "$HOME/.gradle/caches/"
    - "$HOME/.gradle/wrapper/"
after_script:
  - if [ "$TRAVIS_BRANCH" = "master" && "$TRAVIS_PULL_REQUEST" == "false" ];
    then echo "$DOCKER_PASSWORD" | docker login --username "$DOCKER_USERNAME" --password-stdin;
    docker build -t fwmtresourcesvc --build-arg jar=build/libs/fwmt-resource-service-1.0.0.jar .;
    docker tag fwmtresourcesvc sdcplatform/fwmtresourcesvc:$TRAVIS_BUILD_NUMBER;
    docker push sdcplatform/fwmtresourcesvc;
    fi
